opencv_contribのインストール方法

1．OpenCVのダウンロード

GitHubでバージョンtagを確認しながらダウンロードする

https://github.com/opencv/opencv/tags

私の場合，3.4.6を選択した
opencv-3.4.6.zip


解凍
C:\opencv\opencv-3.4.6の配下に解凍した






2．opencv_contribをダウンロード

OpenCVのバージョンTagに合わせてダウンロードする．

githubからダウンロード
https://github.com/opencv/opencv_contrib

https://github.com/opencv/opencv_contrib/releases


opencvと同じフォルダに解凍する



3．フォルダ構成


C:\opencv\opencv-3.4.6の配下に，

opencv_contrib-3.4.6
opencv-3.4.6

という2つのフォルダが用意された状態にした．



4．CMakeを起動し，環境構築

(1)
Where is the source code：「C:/opencv/opencv-3.4.6/opencv-3.4.6」
Where to build the binaries :「C:/opencv/opencv-3.4.6/opencv-3.4.6/build」

ただし，buildフォルダはなければ作成される．

Configuring done　となれば，成功．


(2)
CUDAを使用しないので，

「WITH_CUDA」,WITH_CUBLAS, WITH_CUFFTオプションがチェックされていないことを確認


(3)
「OPENCV_EXTRA_MODULES_PATH」

opencv_contribフォルダのmodulesフォルダを指定する

C:/opencv/opencv-3.4.6/opencv_contrib-3.4.6/modules

ただし，以下のように\を使ってパスを表現してはダメです．configureできません！
（誤）C:\opencv\opencv-3.4.6\opencv_contrib-3.4.6\modules



(4)
「BUILD_opencv_world」をチェック

OpenCVのモジュール群を統合することができる

各モジュールそれぞれの.libが生成されることなく，
「opencv_world341.lib」「opencv_world341.dll」という一つのライブラリが生成されます．


(5)　再度Configureボタンをクリック


(6)　generateボタンをクリックする



5．VisualStudioを用いてビルドする

(1)
C:\opencv\opencv-3.4.6\opencv-3.4.6\build
にある

OpenCV.sln
ファイルをダブルクリック


(2)　バッチビルドする

Releaseモードに切り替えて，

VS2015の
ビルド−バッチビルドをクリックする


「ALL_BUILD」と「INSTALL」のビルド列のx64側をチェックし，

「ビルド」をクリックする．




6．
installフォルダにOpenCVのバイナリファイル群が出力されるので，
通常のOpenCVと同様にこのフォルダをプログラムに使えばよい．


これ以降の使い方は，
もう一つのマニュアルファイルである「OpenCVのインストール方法」を参照する．




